function J2=STtoJ2_new(ST)

J2_b=((1/6).*((ST(1,:)-ST(2,:)).^2+(ST(2,:)-ST(3,:)).^2+ ...
    (ST(3,:)-ST(1,:)).^2))+0.25*(ST(4,:).^2+ST(5,:).^2+ST(6,:).^2);
J2=sqrt(J2_b);